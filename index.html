<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brittany's Self-Care Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .tracker-card {
            background: linear-gradient(145deg, #fce7f3, #fbcfe8);
        }
        .btn-submit {
            background-color: #f472b6;
            transition: all 0.3s ease;
        }
        .btn-submit:hover {
            background-color: #ec4899;
            transform: translateY(-2px);
        }
        .entry {
            background-color: #fde6f4;
            border-left: 4px solid #f472b6;
        }
    </style>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
</head>
<body class="bg-pink-50 flex items-center justify-center min-h-screen py-8">
    <div id="app" class="w-full max-w-6xl mx-auto p-4 md:p-8">
        <div class="tracker-card rounded-3xl shadow-2xl p-6 md:p-10 mb-8">
            <h1 class="text-4xl md:text-5xl font-extrabold text-center text-pink-900 mb-2">Brittany's Self-Care Tracker</h1>
            <p class="text-center text-pink-700 mb-6 md:mb-8">A space to monitor your progress toward your goals.</p>
        </div>

        <!-- Cultivating Mindful Self-Regulation -->
        <div class="tracker-card rounded-3xl shadow-2xl p-6 md:p-10 mb-8">
            <h2 class="text-2xl md:text-3xl font-bold text-pink-800 mb-4">Cultivating Mindful Self-Regulation & Emotional Wellness</h2>
            <!-- Journaling Practice -->
            <div class="mb-6">
                <p class="text-sm md:text-base text-pink-700 mb-2 font-medium">Monitoring Method: Journaling Practice (Daily/After Trigger Events)</p>
                <p class="text-xs md:text-sm text-pink-600 mb-2">What to Track: Log the trigger, emotion, old vs. new response, and outcome.</p>
                <textarea id="mindful-entry" rows="4" placeholder="Log your trigger, emotion, response, and outcome here..."
                    class="w-full p-3 rounded-lg border border-pink-300 focus:outline-none focus:border-pink-500 bg-pink-50 text-pink-800 transition-all duration-300"></textarea>
                <button onclick="addEntry('mindful')"
                    class="btn-submit w-full mt-2 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50">
                    Add Journal Entry
                </button>
            </div>
            <h3 class="text-xl font-semibold text-pink-800 mb-3">Your Journal Entries</h3>
            <div id="mindful-entries-list" class="space-y-3"></div>
            <!-- Weekly Review -->
            <hr class="border-t border-pink-300 my-6">
            <div class="mb-6">
                <p class="text-sm md:text-base text-pink-700 mb-2 font-medium">Monitoring Method: Weekly Review (Self-Rating)</p>
                <p class="text-xs md:text-sm text-pink-600 mb-2">What to Track: Rate your confidence/skill (1-5) and add a brief note on why.</p>
                <div class="flex items-center space-x-4 mb-2">
                    <label for="mindful-rating" class="text-pink-800">Rating:</label>
                    <select id="mindful-rating" class="p-2 rounded-lg border border-pink-300 bg-pink-50 text-pink-800 focus:outline-none focus:border-pink-500">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                </div>
                <textarea id="mindful-review-note" rows="2" placeholder="Brief note on why..."
                    class="w-full p-3 rounded-lg border border-pink-300 focus:outline-none focus:border-pink-500 bg-pink-50 text-pink-800 transition-all duration-300"></textarea>
                <button onclick="addEntry('mindful-review')"
                    class="btn-submit w-full mt-2 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50">
                    Add Weekly Review
                </button>
            </div>
            <h3 class="text-xl font-semibold text-pink-800 mb-3">Your Weekly Reviews</h3>
            <div id="mindful-review-entries-list" class="space-y-3"></div>
        </div>

        <!-- Fostering Sustainable Self-Care -->
        <div class="tracker-card rounded-3xl shadow-2xl p-6 md:p-10 mb-8">
            <h2 class="text-2xl md:text-3xl font-bold text-pink-800 mb-4">Fostering Sustainable Self-Care, Introspection & Intellectual Nourishment</h2>
            <!-- Habit Tracker -->
            <div class="mb-6">
                <p class="text-sm md:text-base text-pink-700 mb-2 font-medium">Monitoring Method: Habit Tracker (Daily/Weekly)</p>
                <p class="text-xs md:text-sm text-pink-600 mb-2">Track your daily habits.</p>
                <div class="flex flex-col space-y-2 text-pink-800">
                    <label class="flex items-center space-x-2"><input type="checkbox" id="habit-read" class="rounded text-pink-500"><span>Read today?</span></label>
                    <label class="flex items-center space-x-2"><input type="checkbox" id="habit-meditate" class="rounded text-pink-500"><span>Meditate today?</span></label>
                    <label class="flex items-center space-x-2"><input type="checkbox" id="habit-water" class="rounded text-pink-500"><span>Drink water today?</span></label>
                    <label class="flex items-center space-x-2"><input type="checkbox" id="habit-journal" class="rounded text-pink-500"><span>Journal today?</span></label>
                    <label class="flex items-center space-x-2"><input type="checkbox" id="habit-intention" class="rounded text-pink-500"><span>Set a morning intention today?</span></label>
                    <label class="flex items-center space-x-2"><input type="checkbox" id="habit-hubby" class="rounded text-pink-500"><span>Spend time with hubby today?</span></label>
                </div>
                <button onclick="addHabitEntry()"
                    class="btn-submit w-full mt-4 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50">
                    Log Habits for Today
                </button>
            </div>
            <h3 class="text-xl font-semibold text-pink-800 mb-3">Your Habit Log</h3>
            <div id="habit-entries-list" class="space-y-3"></div>
            <!-- Quarterly Book/Learning Integration Review -->
            <hr class="border-t border-pink-300 my-6">
            <div class="mb-6">
                <p class="text-sm md:text-base text-pink-700 mb-2 font-medium">Monitoring Method: Quarterly Book/Learning Integration Review</p>
                <p class="text-xs md:text-sm text-pink-600 mb-2">What to Track: Summarize a core idea from a book and how you will apply it to your life.</p>
                <textarea id="selfcare-book-entry" rows="4" placeholder="Summarize a core idea from a book and your plan to integrate it..."
                    class="w-full p-3 rounded-lg border border-pink-300 focus:outline-none focus:border-pink-500 bg-pink-50 text-pink-800 transition-all duration-300"></textarea>
                <button onclick="addEntry('selfcare-book')"
                    class="btn-submit w-full mt-2 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50">
                    Add Learning Review
                </button>
            </div>
            <h3 class="text-xl font-semibold text-pink-800 mb-3">Your Learning Reviews</h3>
            <div id="selfcare-book-entries-list" class="space-y-3"></div>
            <!-- Journaling Tracker -->
            <hr class="border-t border-pink-300 my-6">
            <div class="mb-6">
                <p class="text-sm md:text-base text-pink-700 mb-2 font-medium">Monitoring Method: Journaling Tracker (Exploration Log)</p>
                <p class="text-xs md:text-sm text-pink-600 mb-2">Keep a running list of practices and their helpfulness after a week of use.</p>
                <textarea id="selfcare-journal-entry" rows="4" placeholder="Log a new journaling practice here..."
                    class="w-full p-3 rounded-lg border border-pink-300 focus:outline-none focus:border-pink-500 bg-pink-50 text-pink-800 transition-all duration-300"></textarea>
                <button onclick="addEntry('selfcare-journal')"
                    class="btn-submit w-full mt-2 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50">
                    Add Journaling Log
                </button>
            </div>
            <h3 class="text-xl font-semibold text-pink-800 mb-3">Your Journaling Logs</h3>
            <div id="selfcare-journal-entries-list" class="space-y-3"></div>
        </div>
        
        <!-- Increasing Spiritual Wellness -->
        <div class="tracker-card rounded-3xl shadow-2xl p-6 md:p-10">
            <h2 class="text-2xl md:text-3xl font-bold text-pink-800 mb-4">Increasing Spiritual Wellness</h2>
            <!-- Daily Gratitude & Compassion Log -->
            <div class="mb-6">
                <p class="text-sm md:text-base text-pink-700 mb-2 font-medium">Monitoring Method: Daily Gratitude & Compassion Log</p>
                <p class="text-xs md:text-sm text-pink-600 mb-2">What to Track: Log one thing you're grateful for, and one act of compassion you experienced or performed.</p>
                <textarea id="spiritual-gratitude-entry" rows="4" placeholder="Log your gratitude and a moment of compassion here..."
                    class="w-full p-3 rounded-lg border border-pink-300 focus:outline-none focus:border-pink-500 bg-pink-50 text-pink-800 transition-all duration-300"></textarea>
                <button onclick="addEntry('spiritual-gratitude')"
                    class="btn-submit w-full mt-2 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50">
                    Add Daily Log
                </button>
            </div>
            <h3 class="text-xl font-semibold text-pink-800 mb-3">Your Daily Logs</h3>
            <div id="spiritual-gratitude-entries-list" class="space-y-3"></div>
            
            <!-- Connection & Introspection Review -->
            <hr class="border-t border-pink-300 my-6">
            <div class="mb-6">
                <p class="text-sm md:text-base text-pink-700 mb-2 font-medium">Monitoring Method: Connection & Introspection Review (Weekly)</p>
                <p class="text-xs md:text-sm text-pink-600 mb-2">What to Track: Reflect on a moment you felt a profound sense of connection or peace.</p>
                <textarea id="spiritual-connection-entry" rows="4" placeholder="Reflect on a moment of connection, a lesson, or a peaceful thought..."
                    class="w-full p-3 rounded-lg border border-pink-300 focus:outline-none focus:border-pink-500 bg-pink-50 text-pink-800 transition-all duration-300"></textarea>
                <button onclick="addEntry('spiritual-connection')"
                    class="btn-submit w-full mt-2 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50">
                    Add Weekly Reflection
                </button>
            </div>
            <h3 class="text-xl font-semibold text-pink-800 mb-3">Your Weekly Reflections</h3>
            <div id="spiritual-connection-entries-list" class="space-y-3"></div>
        </div>
    </div>
    <script>
        // REPLACE THE FOLLOWING WITH YOUR OWN FIREBASE CONFIGURATION.
        // Get this from your Firebase console after creating a new project.
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyBKZbp5aa4gepChRwa1zQxcDIdzTtmQzIE",
  authDomain: "new-self-care-tracker.firebaseapp.com",
  projectId: "new-self-care-tracker",
  storageBucket: "new-self-care-tracker.firebasestorage.app",
  messagingSenderId: "791141192999",
  appId: "1:791141192999:web:9355fe8ef1b014c0138502",
  measurementId: "G-ZPVZ6F4ZWN"
};
        };
        
        // This is a special way to get a user ID that works on GitHub Pages and other hosting.
        const appId = firebaseConfig.projectId;
        const initialAuthToken = null; // We are not using a custom token in this version.

        // Firestore and Auth instances
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = app.auth();
        
        let userId = null;
        
        auth.onAuthStateChanged(async (user) => {
            if (user) {
                userId = user.uid;
                // Display the user ID so you know it's working
                document.getElementById('user-id-display').textContent = `User ID: ${userId}`;
                initializeTrackers();
            } else {
                console.log('No user is signed in. Signing in anonymously...');
                try {
                    await auth.signInAnonymously();
                } catch (error) {
                    console.error("Firebase Auth Error:", error);
                }
            }
        });
        
        const initializeTrackers = () => {
            setupListener('mindful', 'mindful-entries-list');
            setupListener('mindful-review', 'mindful-review-entries-list');
            setupListener('habits', 'habit-entries-list');
            setupListener('selfcare-book', 'selfcare-book-entries-list');
            setupListener('selfcare-journal', 'selfcare-journal-entries-list');
            setupListener('spiritual-gratitude', 'spiritual-gratitude-entries-list');
            setupListener('spiritual-connection', 'spiritual-connection-entries-list');
        };
        
        const setupListener = (collectionName, containerId) => {
            db.collection(collectionName).onSnapshot((snapshot) => {
                const entries = [];
                snapshot.forEach((doc) => {
                    entries.push({ id: doc.id, ...doc.data() });
                });
                renderEntries(collectionName, containerId, entries);
            }, (error) => {
                console.error("Error listening to collection:", error);
            });
        };
        
        const addEntry = async (trackerType) => {
            if (!userId) {
                console.error("User not authenticated yet. Cannot add entry.");
                return;
            }
            let inputElement, entryText, collectionName;
            let entryData = {};
        
            switch (trackerType) {
                case 'mindful':
                    inputElement = document.getElementById('mindful-entry');
                    entryText = inputElement.value.trim();
                    collectionName = 'mindful';
                    entryData.text = entryText;
                    break;
                case 'mindful-review':
                    inputElement = document.getElementById('mindful-review-note');
                    const rating = document.getElementById('mindful-rating').value;
                    entryText = inputElement.value.trim();
                    collectionName = 'mindful-review';
                    entryData.text = `Rating: ${rating} | Note: ${entryText}`;
                    break;
                case 'selfcare-book':
                    inputElement = document.getElementById('selfcare-book-entry');
                    entryText = inputElement.value.trim();
                    collectionName = 'selfcare-book';
                    entryData.text = entryText;
                    break;
                case 'selfcare-journal':
                    inputElement = document.getElementById('selfcare-journal-entry');
                    entryText = inputElement.value.trim();
                    collectionName = 'selfcare-journal';
                    entryData.text = entryText;
                    break;
                case 'spiritual-gratitude':
                    inputElement = document.getElementById('spiritual-gratitude-entry');
                    entryText = inputElement.value.trim();
                    collectionName = 'spiritual-gratitude';
                    entryData.text = entryText;
                    break;
                case 'spiritual-connection':
                    inputElement = document.getElementById('spiritual-connection-entry');
                    entryText = inputElement.value.trim();
                    collectionName = 'spiritual-connection';
                    entryData.text = entryText;
                    break;
                default:
                    console.error("Unknown tracker type.");
                    return;
            }
        
            if (!entryText) {
                console.warn("Entry text is empty.");
                return;
            }
        
            try {
                await db.collection(collectionName).add({
                    ...entryData,
                    timestamp: new Date().toISOString()
                });
                if (inputElement) {
                    inputElement.value = '';
                }
            } catch (error) {
                console.error("Error adding document: ", error);
            }
        };
        
        const addHabitEntry = async () => {
            if (!userId) {
                console.error("User not authenticated yet. Cannot add entry.");
                return;
            }
            const habits = ['read', 'meditate', 'water', 'journal', 'intention', 'hubby'];
            const habitData = {};
            habits.forEach(habit => {
                const checkbox = document.getElementById(`habit-${habit}`);
                habitData[habit] = checkbox.checked;
                checkbox.checked = false;
            });
        
            try {
                await db.collection('habits').add({
                    ...habitData,
                    timestamp: new Date().toISOString()
                });
            } catch (error) {
                console.error("Error adding habit entry: ", error);
            }
        };
        
        const editEntry = async (collectionName, docId, newText) => {
            if (!userId) {
                console.error("User not authenticated yet. Cannot edit entry.");
                return;
            }
            try {
                await db.collection(collectionName).doc(docId).update({
                    text: newText
                });
            } catch (error) {
                console.error("Error updating document: ", error);
            }
        };
        
        const deleteEntry = async (collectionName, docId) => {
            if (!userId) {
                console.error("User not authenticated yet. Cannot delete entry.");
                return;
            }
            try {
                await db.collection(collectionName).doc(docId).delete();
            } catch (error) {
                console.error("Error deleting document: ", error);
            }
        };
        
        const renderEntries = (collectionName, containerId, entries) => {
            const container = document.getElementById(containerId);
            if (!container) return;
        
            entries.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            container.innerHTML = '';
        
            entries.forEach(data => {
                const entryElement = document.createElement('div');
                entryElement.className = 'entry p-4 rounded-xl shadow-md';
        
                let content;
                if (collectionName === 'habits') {
                    content = `
                        <p class="text-sm md:text-base text-pink-900 leading-snug font-medium">Habits for ${new Date(data.timestamp.toDate()).toLocaleDateString()}</p>
                        <ul class="list-disc list-inside mt-2 text-pink-800 text-sm">
                            <li><span class="${data.read ? 'line-through text-pink-500' : ''}">Read today? ${data.read ? '✔' : '✖'}</span></li>
                            <li><span class="${data.meditate ? 'line-through text-pink-500' : ''}">Meditate today? ${data.meditate ? '✔' : '✖'}</span></li>
                            <li><span class="${data.water ? 'line-through text-pink-500' : ''}">Drink water today? ${data.water ? '✔' : '✖'}</span></li>
                            <li><span class="${data.journal ? 'line-through text-pink-500' : ''}">Journal today? ${data.journal ? '✔' : '✖'}</span></li>
                            <li><span class="${data.intention ? 'line-through text-pink-500' : ''}">Set a morning intention today? ${data.intention ? '✔' : '✖'}</span></li>
                            <li><span class="${data.hubby ? 'line-through text-pink-500' : ''}">Spend time with hubby today? ${data.hubby ? '✔' : '✖'}</span></li>
                        </ul>
                        <div class="mt-2 flex space-x-2">
                            <button onclick="editEntry('${collectionName}', '${data.id}')" class="text-xs text-white px-2 py-1 rounded-full bg-pink-400 hover:bg-pink-500">Edit</button>
                            <button onclick="deleteEntry('${collectionName}', '${data.id}')" class="text-xs text-white px-2 py-1 rounded-full bg-red-400 hover:bg-red-500">Delete</button>
                        </div>
                    `;
                } else {
                    const date = new Date(data.timestamp.toDate()).toLocaleString();
                    content = `
                        <div id="entry-text-${data.id}" class="text-sm md:text-base text-pink-900 leading-snug break-words mb-2">${data.text}</div>
                        <p class="text-xs text-pink-500 mt-2 font-light">Added on: ${date}</p>
                        <div class="mt-2 flex space-x-2">
                            <button onclick="toggleEdit('${collectionName}', '${data.id}')" class="text-xs text-white px-2 py-1 rounded-full bg-pink-400 hover:bg-pink-500">Edit</button>
                            <button onclick="deleteEntry('${collectionName}', '${data.id}')" class="text-xs text-white px-2 py-1 rounded-full bg-red-400 hover:bg-red-500">Delete</button>
                        </div>
                    `;
                }
                entryElement.innerHTML = content;
                container.appendChild(entryElement);
            });
        };
        
        const toggleEdit = (collectionName, docId) => {
            const entryTextDiv = document.getElementById(`entry-text-${docId}`);
            if (!entryTextDiv) {
                console.error("Entry element not found.");
                return;
            }
        
            const originalText = entryTextDiv.innerText;
            const textarea = document.createElement('textarea');
            textarea.className = "w-full p-2 rounded-lg border border-pink-300 focus:outline-none bg-pink-50 text-pink-800 transition-all duration-300";
            textarea.value = originalText;
            textarea.rows = 4;
        
            const saveButton = document.createElement('button');
            saveButton.className = "btn-submit text-white font-semibold py-2 px-4 rounded-lg shadow-md mt-2 hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-50";
            saveButton.innerText = "Save";
            saveButton.onclick = () => {
                editEntry(collectionName, docId, textarea.value);
            };
        
            const cancelButton = document.createElement('button');
            cancelButton.className = "btn-submit text-white font-semibold py-2 px-4 rounded-lg shadow-md mt-2 ml-2 bg-gray-400 hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50";
            cancelButton.innerText = "Cancel";
            cancelButton.onclick = () => {
                setupListener(collectionName, `${collectionName}-entries-list`);
            };
        
            entryTextDiv.innerHTML = '';
            entryTextDiv.appendChild(textarea);
            entryTextDiv.appendChild(saveButton);
            entryTextDiv.appendChild(cancelButton);
        };
        
        window.onload = () => {
            // Note: We don't initialize trackers here, as it's done after auth state change.
            // We just ensure the buttons are globally available.
            window.addEntry = addEntry;
            window.addHabitEntry = addHabitEntry;
            window.editEntry = editEntry;
            window.deleteEntry = deleteEntry;
            window.toggleEdit = toggleEdit;
        };
    </script>
</body>
</html>
